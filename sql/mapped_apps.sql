SELECT DISTINCT ON (crm.repo_id, crm.component_id, crm.app_id, crm.clone_url_ssh)
    crm.repo_id AS repo_id,
    crm.host_name AS host_name,
    crm.project_key AS project_key,
    crm.repo_slug AS repo_slug,
    crm.component_id AS component_id,
    crm.app_id AS app_id,
    crm.tc AS tc,
    crm.web_url AS web_url,
    crm.clone_url_ssh AS clone_url_ssh,
    crm.status AS status,
    crm.comment AS comment,
    crm.classification_label AS classification_label,
    crm.executable_lines_of_code AS executable_loc,
    crm.avg_cyclomatic_complexity AS avg_cyclomatic_complexity,
    crm.total_token_count AS total_token_count,
    crm.function_count AS function_count,
    crm.total_cyclomatic_complexity AS total_cyclomatic_complexity,
    crm.source_code_file_count AS source_code_file_count,
    crm.total_blank AS total_blank,
    crm.total_comment AS total_comment,
    crm.total_lines_of_code AS total_loc,
    crm.iac_ansible AS iac_ansible,
    crm.iac_azure_pipelines AS iac_azure_pipelines,
    crm.iac_bitbucket_pipelines AS iac_bitbucket_pipelines,
    crm.iac_circleci_pipelines AS iac_circleci_pipelines,
    crm.iac_cloudformation AS iac_cloudformation,
    crm.iac_dockerfile AS iac_dockerfile,
    crm.iac_github_actions AS iac_github_actions,
    crm.iac_gitlab_ci AS iac_gitlab_ci,
    crm.iac_kubernetes AS iac_kubernetes,
    crm.iac_no_checks AS iac_no_checks,
    crm.iac_openapi AS iac_openapi,
    crm.iac_secrets AS iac_secrets,
    crm.iac_terraform AS iac_terraform,
    crm.iac_terraform_plan AS iac_terraform_plan,
    crm.total_trivy_vulns AS total_trivy_vulns,
    crm.trivy_critical AS trivy_critical,
    crm.trivy_high AS trivy_high,
    crm.trivy_medium AS trivy_medium,
    crm.trivy_low AS trivy_low,
    crm.total_semgrep_findings AS total_semgrep_findings,
    crm.cat_best_practice AS cat_best_practice,
    crm.cat_compatibility AS cat_compatibility,
    crm.cat_correctness AS cat_correctness,
    crm.cat_maintainability AS cat_maintainability,
    crm.cat_performance AS cat_performance,
    crm.cat_portability AS cat_portability,
    crm.cat_security AS cat_security,
    crm.language_count AS language_count,
    crm.main_language AS main_language,
    crm.all_languages AS all_languages,
    crm.repo_size_bytes AS repo_size_bytes,
    crm.file_count AS file_count,
    crm.total_commits AS total_commits,
    crm.number_of_contributors AS number_of_contributors,
    crm.activity_status AS activity_status,
    crm.last_commit_date AS last_commit_date,
    crm.repo_age_days AS repo_age_days,
    crm.active_branch_count AS active_branch_count,
    crm.updated_at AS updated_at
FROM combined_repo_metrics AS crm

ORDER BY
    crm.repo_id, crm.component_id, crm.app_id, crm.clone_url_ssh;
